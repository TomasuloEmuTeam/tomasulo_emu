<!DOCTYPE html>

<html>
<head>
    <title>Tomasulo Emulator</title>
    <meta charset="utf-8"/>

    <link rel=stylesheet href="../node_modules/codemirror/lib/codemirror.css">
    <link rel=stylesheet href="../node_modules/jsgrid/dist/jsgrid.min.css">
    <link rel=stylesheet href="../node_modules/jsgrid/dist/jsgrid-theme.min.css">
    <link rel=stylesheet href="../node_modules/bootstrap/dist/css/bootstrap.min.css">

    <script src="../node_modules/jquery/dist/jquery.min.js"></script>

    <script src="../node_modules/codemirror/lib/codemirror.js"></script>
    <script src="../node_modules/codemirror/mode/xml/xml.js"></script>
    <script src="../node_modules/codemirror/mode/javascript/javascript.js"></script>
    <script src="../node_modules/codemirror/mode/css/css.js"></script>
    <script src="../node_modules/codemirror/mode/htmlmixed/htmlmixed.js"></script>
    <script src="../node_modules/codemirror/addon/edit/matchbrackets.js"></script>
    <script src="../node_modules/codemirror/addon/selection/active-line.js"></script>

    <script src="../node_modules/jsgrid/dist/jsgrid.min.js"></script>
    <script src="../node_modules/sprintf-js/dist/sprintf.min.js"></script>

    <script src="../__javascript__/emulator.js"></script>
    <script src="js/control.js"></script>
</head>


<body>
<div class="container-fluid">
    <h1>Tomasulo Machine</h1>
    <div id="controlPanel">
        <button class="btn btn-info btn-sm" id="btnRun">Run</button>
        <button class="btn btn-info btn-sm" id="btnStep">Step</button>
        <button class="btn btn-info btn-sm" id="btnReset">Reset</button>
    </div>
    <div class="row">
        <div class="col-lg-3">

            <h2>Instructions</h2>
            <div id="textCurrentPC">PC: 0x12</div>
            <textarea id="textInstructions">
ADDD F1, F2, F3
SUBD F1, F2, F3
MULD F1, F2, F3
DIVD F1, F2, F3
LD F1, ADDR
ST F1, ADDR
ADDD F1, F2, F3
ADDD F1, F2, F3
ADDD F1, F2, F3
SUBD F1, F2, F3
MULD F1, F2, F3
DIVD F1, F2, F3
LD F1, ADDR
ST F1, ADDR
SUBD F1, F2, F3
MULD F1, F2, F3
DIVD F1, F2, F3
LD F1, ADDR
ST F1, ADDR
SUBD F1, F2, F3
MULD F1, F2, F3
DIVD F1, F2, F3
LD F1, ADDR
ST F1, ADDR</textarea>
        </div>
        <div class="col-lg-8">
            <h2>Memory Editor</h2>
            <div id="memoryEditor"></div>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-3">
            <h2>Float Registers</h2>
            <div id="tableFloatRegs"></div>
        </div>
        <div class="col-lg-3">
            <h2>Integer Registers</h2>
            <div id="tableIntRegs"></div>
        </div>
        <div class="col-lg-2">
            <h2>Load Queue</h2>
            <div id="tableLoadQueue"></div>
        </div>
        <div class="col-lg-2">
            <h2>Store Queue</h2>
            <div id="tableStoreQueue"></div>
        </div>
    </div>

    <h2>Reservation Stations</h2>
    <div id="tableReservationStations"></div>
</div>

<script>
    CodeMirror.fromTextArea(document.getElementById("textInstructions"), {
        lineNumbers: true,
//        mode: "text/html",
        matchBrackets: true,
        styleActiveLine: true,
        gutters: ["CodeMirror-linenumber", "breakpoints"],

    }).on("gutterClick", function(cm, n) {
        let info = cm.lineInfo(n);
        cm.setGutterMarker(n, "breakpoints", info.gutterMarkers ? null : makeMarker());
    });

    function makeMarker() {
        let marker = document.createElement("div");
        marker.style.color = "#822";
        marker.innerHTML = "‚óè";
        return marker;
    }

</script>

</body>
</html>

